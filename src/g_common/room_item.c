/*
	Room item

	Copyright (C) 2009-2013	Patrice Mandin

	This program is free software; you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation; either version 2 of the License, or
	(at your option) any later version.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program; if not, write to the Free Software
	Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
*/

#include <string.h>
#include <SDL.h>

#include "../log.h"
#include "../parameters.h"
#include "../filesystem.h"

#include "room.h"
#include "room_item.h"

/*--- Functions prototypes ---*/

static void addItem(room_t *this, room_item_t *item);

/*--- Functions ---*/

void room_item_init(room_t *this)
{
	this->addItem = addItem;
}

static void addItem(room_t *this, room_item_t *item)
{
	this->items = realloc(this->items, (this->num_items+1) * sizeof(room_item_t));
	if (!this->items) {
		logMsg(0, "room_item: Can not allocate memory for item\n");
		return;
	}

	memcpy(&this->items[this->num_items], item, sizeof(room_item_t));
	logMsg(1, "room_item: Adding item %d (x=%d,y=%d,%dx%d)\n", this->num_items,
		item->x,item->y,item->w,item->h);

	++this->num_items;
}

/*
	re2

	no model, pickable hint, spade key
[    0.277] 0x0000016c: # 0x4e 0x09 0x02 0x31 0x00 0x00 0x4c 0x3e 0x0d 0x25 0x01 0x00 0x01 0x00 0x59 0x00 0x01 0x00 0x5d 0x00 0x01 0xa0
	model, pickable hint, ribbon
[    0.278] 0x000001d0: # 0x4e 0x04 0x02 0x31 0x01 0x00 0x4d 0xd2 0x73 0xed 0x14 0x0a 0x4c 0x09 0x1e 0x00 0x03 0x00 0xa6 0x00 0x03 0x00

[    0.277] 0x00000184: # 0x2d 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x0a 0x00 0x10 0x00 0x2e 0xca 0x91 0xf9 0x18 0xe0 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
[    0.277] 0x00000184:   TRIGGER #0x01 = TRIGGER_SET xxx
obj_model_set

[    0.277] 0x000001aa: # 0x2d 0x02 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x0a 0x00 0x10 0x00 0x70 0xca 0xfe 0xf9 0x18 0xdd 0x80 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
[    0.277] 0x000001aa:   TRIGGER #0x02 = TRIGGER_SET xxx
obj_model_set

[    0.278] 0x000001d0: # 0x4e 0x04 0x02 0x31 0x01 0x00 0x4d 0xd2 0x73 0xed 0x14 0x0a 0x4c 0x09 0x1e 0x00 0x03 0x00 0xa6 0x00 0x03 0x00
ribbon

[    0.278] 0x000001e6: # 0x2d 0x03 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x0a 0x00 0x10 0x00 0x35 0xd9 0x80 0xf3 0xd9 0xf3 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
[    0.278] 0x000001e6:   TRIGGER #0x03 = TRIGGER_SET xxx
obj_model_set

*/
